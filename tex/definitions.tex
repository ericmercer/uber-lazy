\subsection{Definitions}

\begin{definition}
\label{def:state}
The set of \textbf{states} $\mathcal{S}$ is defined as
\end{definition}

\begin{definition}
\label{def:initate}
The set of \textbf{initial states} $\mathcal{S}_0$ is defined as (TBD)
\end{definition}

\begin{definition}
The set of \textbf{references} $\mathcal{R}$ is defined as the set of natural numbers
 $$\mathcal{R} = \mathbb{N}$$
\end{definition}

The total number of references in a summary state and a lazy state that it represents are generally not the same. However, the number of references on the stack in either state is always the same. In order to make the distinction between different types of references, we partition the set of natural numbers using modular arithmetic.

\begin{definition}
The set of \textbf{stack references} $\mathcal{R}_t$ is defined as
 $$\mathcal{R}_t =\{i \in \mathbb{N} \mid ( i\ \bmod\ 3 ) = 0\}$$. 
\end{definition}

\begin{definition}
The set of \textbf{input heap references} $\mathcal{R}_h$ is defined as
 $$\mathcal{R}_h =\{i \in \mathbb{N} \mid ( i\ \bmod\ 3 ) = 1\}$$. 
\end{definition}

\begin{definition}
The set of \textbf{new heap references} $\mathcal{R}_f$ is defined as
 $$\mathcal{R}_n =\{i \in \mathbb{N} \mid ( i\ \bmod\ 3 ) = 2\}$$. 
\end{definition}

\begin{definition}
For a given function $f:A \mapsto B$, the \textbf{image} $f^\rightarrow$ and \textbf{preimage} $f^\leftarrow$ are defined as
\begin{align}
 f^\rightarrow &= \{ f(a) \mid a \in A\}\\
 f^\leftarrow &= \{ a \mid f(a) \in B \}
 \end{align}
 The bracket notation $ f^\rightarrow [C] $ is used to denote that the image is drawn from a specific subset:
 \begin{align}
 f^\rightarrow [C] &= \{ f(a) \mid a \in C\}\\
 f^\leftarrow [D] &= \{ a \mid f(a) \in D \}
 \end{align}
 Where $C \subset A$ and $D \subset B$
\end{definition}

\begin{definition}
A \textbf{state transition function} $\rightarrow_{\Phi}$ is a mapping $\rightarrow_{\Phi} : s \mapsto s$, which takes one machine state and transforms it into another machine state. Two important state transition functions are the \textbf{lazy state transition function} $\rightarrow_\ell$ and the \textbf{summary state transition function} $\rightarrow_s$.
\end{definition}

\begin{definition}
A \textbf{state sequence} is a sequence of states denoted as $\Pi_n = s_0,s_1,...,s_n$. A \textbf{feasible state sequence}, $\Pi_n^\phi = s_0,s_1,...,s_n$ is consistent with the transition: $\forall i\ (0 \leq i < n \Rightarrow s_i \rightarrow_{\Phi} s_{i+1})$, where $s_0\in \mathcal{S}_0$.
\end{definition}

\begin{comment}
\begin{definition}
A \textbf{feasible state sequence} is defined as a sequence of states resulting from repeated application of the state transition relation to some initial state $s_0\in \mathcal{S}_0$: $$\Pi_n = s_0,s_1,...,s_n$$ where the relation $s_i \rightarrow_{\Phi} s_{i+1}$ holds for all $i \in \{ i | 0 \leq i < n \}$
\end{definition}
\end{comment}

%For these definitions, we should bring in the notion of 
\begin{definition}
The set of \textbf{lazy states} $\mathcal{S}_\ell$ is defined as
\begin{align}
\mathcal{S}_\ell = \{s_\ell \mid \exists \Pi_n^\ell\ (\Pi_n^\ell = s_0, \ldots, s_\ell)\}
\end{align}
\end{definition}

\begin{definition}
The set of \textbf{summary states} $\mathcal{S}_s$ is defined as
\begin{align}
\mathcal{S}_s = \{s_s \mid \exists \Pi_n^s\ (\Pi_n^s = s_0, \ldots, s_s)\}
\end{align}
\end{definition}

\begin{definition}
\label{def:interstate}
\textbf{Intermediate states} are imaginary placeholder states used when reasoning about complex transition rules in terms of simpler sub-rules. For example, the transition $s_x \rightarrow_\phi s_y$ may be equivalent to a sequence of simpler transitions $s_x \rightarrow_\alpha s_a \rightarrow_\beta s_b \rightarrow_\gamma s_y$.  When reasoning about this equivalent transition sequence, it can be useful to discuss the notional intermediate states $s_a$ and $s_b$. However, it is important to remember that $s_a$ and $s_b$ are not technically involved in the transition $s_x \rightarrow_\phi s_y$, and indeed may not be part of any feasible state sequence under transition relation $\rightarrow_\phi$.
\end{definition}

\begin{definition}
Given a sequence of states $$\Pi_n = s_0,s_1,...,s_n$$ where $$s_i = ( \mu_i\ \cfgnt{L}_i\ \cfgnt{R}_i\ \phi_i\ \eta_i\ \cfgnt{e}_i\ \cfgnt{k}_i )$$ the \textbf{control flow sequence} of $\Pi_n$ is the defined as the sequence of tuples $$ \pi_n = \mathbb{CF}(\Pi_n) = (\eta_0\ \cfgnt{e}_0\ \cfgnt{k}_0),(\eta_1\ \cfgnt{e}_1\ \cfgnt{k}_1),...,(\eta_n\ \cfgnt{e}_n\ \cfgnt{k}_n)$$
\end{definition}

\begin{definition}
Given a state transition function $\rightarrow_{\Phi}$, an initial state $s_0$ and a control flow sequence $\pi_n$, the \textbf{feasible state set}, $\mathbb{FS}(\rightarrow_{\Phi},s_0,\pi_n)$, is defined as
 $$
\begin{array}{l}
\mathbb{FS}(\rightarrow_{\Phi},s_0,\pi_n) = \\
\ \ \ \ \ \ \{s \mid \exists \Pi_n^\phi\ (\pi_n = \mathbb{CF}(\Pi_n^\Phi) \wedge s = \mathit{last}(\Pi_n))\} 
\end{array}
$$
where $\mathit{last}(\Pi_n)$ returns the last state on the feasible sequence.
\end{definition}

%\begin{definition}
%A \textbf{field access descriptor} $\gamma_i$ is a tuple 
%$$ \gamma_i = (\cfgnt{r}_i\ \phi_i\ \cfgnt{l}_i\ \cfgnt{f}_i)$$
%\end{definition}
%
%\begin{definition}
%An \textbf{access path} $\Gamma_n$ is a sequence of field access descriptors
%$ \Gamma_n = \gamma_0,\gamma_1,...,\gamma_n $.
%\end{definition}
%
%\begin{definition}
%For a given access path $\Gamma_n$ the \textbf{access path constraint} $\mathbb{PC}(\Gamma_n)$ is defined as
%$$\mathbb{PC}(\Gamma_n) =  \bigwedge \{\phi \mid \exists \gamma \in \Gamma_n \ (\gamma = (\cfgnt{r}\ \phi\ \cfgnt{e}\ \cfgnt{f}))\}$$  
%\end{definition}
%
%\begin{definition}
%For a given state $s= ( \cfgnt{L}_s\ \cfgnt{R}_s\ \phi_s\ \eta_s\ \cfgnt{e}_s\ \cfgnt{k}_s )$, a \textbf{valid access path} $\Gamma_n^s = \gamma_0,\gamma_1,...,\gamma_n$ satisfies the properties
%\begin{align*}
%\cfgnt{r}_0 &\in \mathit{refs}(\eta_s) \\
%\mathbb{S}(&\phi_s \wedge \mathbb{PC}(\Gamma_n^s)) \\
%\forall i & \in \mathbb{N}\ ( 0 \leq i < n \Leftrightarrow \gamma_i \in \Gamma_n^s\  \wedge\\
%&\ \ \ \  \gamma_{i+1} \in \Gamma_n^s\  \wedge\\
%&\ \ \ \  (\phi_i\ \cfgnt{l}_i)\in \cfgnt{L}_s(\cfgnt{r}_i)\ \wedge \\
%&\ \ \ \  \cfgnt{r}_{i+1} = \cfgnt{R}_s(\cfgnt{l}_i,\cfgnt{f}_i)\ \wedge\\
%&\ \ \ \ (\phi_{i+1}\ \cfgnt{l}_{i+1}) = \cfgnt{L}_s(\cfgnt{r}_{i+1}) )
%\end{align*}
%where $\gamma_i = (\cfgnt{r}_i\ \phi_i\ \cfgnt{l}_i\ \cfgnt{f}_i)$
%\end{definition}

\begin{definition}
\label{def:homomorphism}
A \textbf{homomorphism} $s_x \rightharpoonup_{h} s_y$, from state $s_x = ( \cfgnt{L}_x\ \cfgnt{R}_x\ \phi_x\ \eta_x\ \cfgnt{e}_x\ \cfgnt{k}_x )$ to state $s_y = ( \cfgnt{L}_y\ \cfgnt{R}_y\ \phi_y\ \eta_y\ \cfgnt{e}_y\ \cfgnt{k}_y )$, is defined as follows: 
$$
\begin{array}{l}
 s_x \rightharpoonup_{h} s_y \Leftrightarrow \\
\ \ \ \ \exists h: \mathcal{L} \mapsto \mathcal{L}\ (\forall \cfgnt{l}_\alpha \in \mathcal{L}\ (\forall \cfgnt{l}_\beta \in \mathcal{L}\ ( \forall f \in \mathcal{F}( \exists \phi_\alpha \in \Phi(\exists \phi_\beta \in \Phi( \\ 
\ \ \ \ \ \ \ \ \ \ \ \ (\phi_a\ \cfgnt{l}_\alpha) \in \cfgnt{L}_x(\cfgnt{R}_x (\cfgnt{l}_\beta,f )) \Rightarrow (\phi_b\ h(\cfgnt{l}_\alpha))\in \cfgnt{L}_y(\cfgnt{R}_y (h(\cfgnt{l}_\beta),f ))\ \\
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  )) ) ) ) )
\end{array}
$$
\end{definition}

\begin{definition}
\label{def:hc}
Given homomorphism $s_x \rightharpoonup_{h} s_y$, the \textbf{homomorphism constraint} $\mathbb{HC}(s_x \rightharpoonup_{h} s_y)$ is defined as:
\begin{align*}
\mathbb{HC}(s_x \rightharpoonup_{h} s_y) &= \\
 \bigwedge \{ \phi_b\ | \exists (\phi_a\ l) \in \cfgnt{L}_x^\rightarrow ( (\phi_b\ h(l)) \in \cfgnt{L}^\rightarrow)\} 
\end{align*}
\end{definition}

\begin{definition}
\label{representation}
The \textbf{representation relation} is defined as follows: given lazy state $s_\ell = ( \cfgnt{L}_\ell\ \cfgnt{R}_\ell\ \phi_\ell\ \eta_\ell\ \cfgnt{e}_\ell\ \cfgnt{k}_\ell )$ and summary state $s_s = ( \cfgnt{L}_s\ \cfgnt{R}_s\ \phi_s\ \eta_s\ \cfgnt{e}_s\ \cfgnt{k}_s )$, $s_\ell \sqsubset s_s $ if and only if $\eta_{\ell} = \eta_{s} ,\ \cfgnt{e}_{\ell} = \cfgnt{e}_{s} ,\ \cfgnt{k}_{\ell} = \cfgnt{k}_{s}$, and there exists a homomorphism $\ s_\ell \rightharpoonup_{h} s_s $ such that 
\begin{equation}
\label{eqn:valid}
 \mathbb{S}( \phi_s \wedge \mathbb{HC}(s_\ell \rightharpoonup_{h} s_s) ) 
\end{equation}
\end{definition}

\begin{definition}
\label{equivalent}
A summary state $s_s$ is \textbf{equivalent} to a set of lazy states $P$ if and only if $s_s$ represents every state in $P$ and represents no other state: 
$$s_s \cong P \Leftrightarrow (\forall s_i \in \mathcal{S}\ (s_i \in P \Leftrightarrow s_i \sqsubset s_s) )$$
\end{definition}

\begin{definition}
\label{sound}
A state $s_s$ is \textbf{sound} with respect to a transition relation, $\rightarrow_\phi$, initial state, $s_0$, and control flow path, $\pi_n$, if and only if 
$$ \forall s_\ell \in \mathcal{S}_\ell\ (s_\ell \sqsubset s_s \Rightarrow s_\ell \in \mathbb{FS}(\rightarrow_{\phi},s_0,\pi_n) ) $$
\end{definition}

\begin{definition}
\label{complete}
A state $s_s$ is \textbf{complete} with respect to a transition relation, $\rightarrow_\phi$, initial state, $s_0$, and control flow path, $\pi_n$, if and only if 
$$ \forall s_\ell \in \mathcal{S}_\ell\ ( s_\ell \in \mathbb{FS}(\rightarrow_{\phi},s_0,\pi_n)\Rightarrow s_\ell \sqsubset s_s ) $$
\end{definition}

\begin{definition}
\label{exact}
A state $s$ is \textbf{exact} with respect to a transition relation, $\rightarrow_\phi$, initial state, $s_0$, and control flow path, $\pi_n$, if and only if it is both sound and complete:
$$ s \cong \mathbb{FS}(\rightarrow_{\phi},s_0,\pi_n)$$
\end{definition}

